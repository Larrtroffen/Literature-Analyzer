# 用户操作手册

## 概述

文献分析应用是一个基于Streamlit的交互式工具，专门用于分析从Web of Science (WoS)导出的Full Record Excel文件。本手册将指导您如何使用应用的各种功能来探索文献数据、发现研究热点和进行学科分析。

## 系统要求

- 现代Web浏览器（Chrome、Firefox、Safari、Edge等）
- 稳定的网络连接（用于下载NLP模型）

## 快速开始

### 1. 启动应用

如果您已经按照README中的说明安装了应用，可以通过以下命令启动：

```bash
streamlit run app.py
```

应用将在默认浏览器中自动打开，通常地址为 `http://localhost:8501`

### 2. 界面布局

应用界面采用双栏布局：
- **左侧边栏**：控制面板，包含数据上传、分析参数设置和筛选控件
- **右侧主区域**：内容展示区，使用标签页组织不同的分析视图

## 详细操作指南

### 第一步：数据上传与处理

#### 1.1 上传数据文件

1. 在左侧边栏找到"数据加载与分析"部分
2. 点击"上传WoS Excel文件"按钮
3. 选择一个或多个从Web of Science导出的Full Record Excel文件
4. 支持的文件格式：`.xlsx`, `.xls`

**注意事项：**
- 确保Excel文件包含以下必需列：
  - `Article Title`（文章标题）
  - `Source Title`（期刊标题）
  - `Publication Year`（发表年份）
  - `Abstract`（摘要）
- 可以同时上传多个文件，系统会自动合并

#### 1.2 处理数据

1. 上传文件后，点击"1. 加载并处理数据"按钮
2. 系统将自动执行以下操作：
   - 合并多个Excel文件
   - 筛选和重命名列
   - 去除重复记录
   - 处理缺失值
   - 文本预处理
3. 处理完成后，在"数据概览"标签页中查看结果

### 第二步：嵌入与降维分析

#### 2.1 选择嵌入模型

1. 在"嵌入模型选择"下拉菜单中选择一个预训练模型：
   - `all-MiniLM-L6-v2`：轻量级模型，速度快，适合快速分析
   - `all-mpnet-base-v2`：平衡型模型，质量和速度都较好
   - `text-embedding-ada-002`：高质量模型，适合深度分析

**建议：**
- 首次使用建议选择`all-MiniLM-L6-v2`
- 大数据集（>5000篇）建议使用轻量级模型
- 需要高精度分析可选择高质量模型

#### 2.2 配置UMAP参数

调整以下参数来控制降维效果：

1. **n_neighbors（邻居数量）**：
   - 范围：5-50
   - 默认值：15
   - 说明：控制局部结构与全局结构的平衡
   - 较小值：保留更多局部细节
   - 较大值：更注重全局结构

2. **min_dist（最小距离）**：
   - 范围：0.0-0.99
   - 默认值：0.1
   - 说明：控制点之间的紧密程度
   - 较小值：点更聚集，适合发现聚类
   - 较大值：点更分散，结构更清晰

#### 2.3 执行嵌入与降维

1. 设置好参数后，点击"2. 执行嵌入与降维"按钮
2. 系统将：
   - 加载选定的嵌入模型
   - 生成文本的语义向量
   - 使用UMAP进行降维
3. 完成后可在"语义空间探索"标签页查看3D散点图

### 第三步：主题建模分析

#### 3.1 配置BERTopic参数

1. **min_topic_size（最小主题大小）**：
   - 范围：5-100
   - 默认值：10
   - 说明：每个主题至少包含的文档数量
   - 较小值：产生更多细粒度主题
   - 较大值：产生更少但更稳定的主题

2. **nr_topics（主题数量）**：
   - 选项：`auto` 或具体数字（5-50）
   - 默认值：`auto`
   - 说明：限制主题数量
   - `auto`：让算法自动确定最佳主题数
   - 具体数字：强制生成指定数量的主题

#### 3.2 执行主题分析

1. 配置好参数后，点击"3. 执行主题分析"按钮
2. 系统将：
   - 训练BERTopic模型
   - 识别主题并为每个主题生成关键词
   - 为每篇文档分配主题
3. 完成后可在"主题分析"、"期刊对比"和"时间趋势"标签页查看结果

## 分析视图详解

### 数据概览

显示数据处理的基本统计信息：
- **原始记录数**：上传的Excel文件中的总记录数
- **处理后记录数**：经过清洗和筛选后的有效记录数
- **数据表格**：显示处理后数据的前10行
- **下载按钮**：可下载包含所有分析结果的完整CSV文件

### 语义空间探索

3D散点图展示文献在语义空间中的分布：
- **交互功能**：
  - 鼠标拖拽：旋转视角
  - 滚轮：缩放
  - 悬停：查看文献详细信息
- **颜色映射**：
  - 按主题：不同主题用不同颜色标识
  - 按期刊：不同期刊用不同颜色标识
  - 按年份：不同年份用渐变色标识
- **期刊分析**：
  - 凸包：显示选定期刊的覆盖范围
  - 中心点：标记期刊的语义中心位置

### 主题分析

#### 主题分布图
- 条形图显示每个主题包含的文献数量
- 可以快速了解主要研究热点
- 点击条形可以筛选特定主题的文献

#### 主题词云
- 为每个主题生成词云图
- 词的大小代表在主题中的重要性
- 通过下拉菜单选择不同主题查看
- "Unclassified"主题不生成词云

### 期刊对比

堆叠条形图展示不同期刊的主题分布：
- X轴：期刊名称
- Y轴：归一化的主题比例（0-100%）
- 不同颜色代表不同主题
- 可以比较不同期刊的研究侧重点

### 时间趋势

折线图展示主题随时间的演变：
- X轴：发表年份
- Y轴：该年度主题的文献数量或比例
- 不同线条代表不同主题
- 可以识别研究趋势的变化

## 数据筛选与交互

### 年份筛选
- 使用滑块选择年份范围
- 只显示选定年份范围内的文献
- 实时更新所有图表

### 期刊筛选
- 多选框选择感兴趣的期刊
- 支持搜索快速定位期刊
- 只显示选定期刊的文献和分析结果

### 主题筛选
- 多选框选择感兴趣的主题
- 可以排除"Unclassified"主题
- 只显示选定主题的文献

### 关键词搜索
- 在标题和摘要中搜索关键词
- 支持布尔运算符（AND, OR, NOT）
- 实时高亮匹配结果

## 工具功能

### 清除缓存并重置
- 点击"清除所有缓存并重置"按钮
- 清除所有计算结果和缓存数据
- 重置应用到初始状态
- 适用于重新开始分析或释放内存

## 最佳实践建议

### 数据准备
1. **数据质量**：确保WoS导出数据完整，包含必需字段
2. **文件大小**：单次分析建议不超过10,000篇文献
3. **时间范围**：合理设置时间范围，避免数据过于分散

### 参数调优
1. **嵌入模型**：
   - 快速预览：使用轻量级模型
   - 最终分析：使用高质量模型
2. **UMAP参数**：
   - 发现细粒度聚类：减小n_neighbors和min_dist
   - 观察全局结构：增大n_neighbors和min_dist
3. **主题参数**：
   - 广泛探索：设置较小的min_topic_size
   - 聚焦主要主题：设置较大的min_topic_size

### 结果解读
1. **语义空间**：观察聚类模式，识别研究社区
2. **主题分析**：结合词云和主题名称理解研究内容
3. **期刊对比**：识别期刊的特色和重叠领域
4. **时间趋势**：发现新兴研究主题和衰退领域

## 常见问题

### Q: 为什么某些文献被标记为"Unclassified"？
A: 这些文献没有被算法分配到任何特定主题，通常是因为内容独特或噪声较多。

### Q: 3D散点图显示缓慢怎么办？
A: 尝试减少显示的文献数量，使用筛选功能，或选择更轻量的嵌入模型。

### Q: 主题分析结果不理想怎么办？
A: 尝试调整BERTopic参数，特别是min_topic_size，或者检查数据质量。

### Q: 可以下载分析结果吗？
A: 是的，在"数据概览"标签页提供CSV下载按钮，包含所有分析结果。

## 技术支持

如遇到技术问题或有功能建议，请：
1. 检查本手册是否已有相关说明
2. 查看控制台错误信息
3. 联系开发团队或提交Issue

---

*本手册将随应用更新而持续完善，建议定期查看最新版本。*
